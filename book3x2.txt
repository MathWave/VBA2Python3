Function NextBuy03(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            NextBuy03 = Buy03    ElseIf Operation = "Buy" And Price = 102 Then            If Buy02 <> 0 Then                NextBuy03 = Volume            Else                NextBuy03 = Buy03            End If    ElseIf Operation = "Sell" And Price = 101 Then            If Volume >= Buy01 + Buy11 Then                NextBuy03 = 0            Else                NextBuy03 = Buy03            End If    Else            If Buy01 = 0 Then                NextBuy03 = Buy03            ElseIf Volume >= Buy01 Then                NextBuy03 = 0            Else                NextBuy03 = Buy03            End If    End IfEnd FunctionFunction NextBuy02(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            NextBuy02 = Buy02    ElseIf Operation = "Buy" And Price = 102 Then            If Buy01 = 0 Then                NextBuy02 = 0            ElseIf Buy02 <> 0 Then                NextBuy02 = Buy02            Else                NextBuy02 = Volume            End If    ElseIf Operation = "Sell" And Price = 101 Then            If Volume < Buy01 + Buy11 Then                NextBuy02 = Buy02            ElseIf Volume < Buy01 + Buy02 + Buy11 + Buy12 Then                NextBuy02 = Buy03            Else                NextBuy02 = 0            End If    Else            If Buy02 = 0 Then                NextBuy02 = 0            Else                If Volume < Buy01 Then                    NextBuy02 = Buy02                ElseIf Volume < Buy01 + Buy02 Then                    NextBuy02 = Buy03                Else                    NextBuy02 = 0                End If            End If    End If    End FunctionFunction NextBuy01(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            NextBuy01 = Buy01    ElseIf Operation = "Buy" And Price = 102 Then            If Buy01 = 0 Then                If Sell01 + Sell11 = 0 Then                    NextBuy01 = Volume                ElseIf Sell02 + Sell12 = 0 Then                    If Volume > Sell01 + Sell11 Then                        NextBuy01 = Volume - Sell01 - Sell11                    Else                        NextBuy01 = 0                    End If                ElseIf Sell03 + Sell13 = 0 Then                    If Volume > Sell01 + Sell11 + Sell02 + Sell12 Then                        NextBuy01 = Volume - Sell01 - Sell11 - Sell02 - Sell12                    Else                        NextBuy01 = 0                    End If                Else                    If Volume > Sell01 + Sell02 + Sell03 + Sell11 + Sell12 + Sell13 Then                        NextBuy01 = Volume - Sell01 - Sell02 - Sell03 - Sell11 - Sell12 - Sell13                    Else                        NextBuy01 = 0                    End If                End If            Else                NextBuy01 = Buy01            End If    ElseIf Operation = "Sell" And Price = 101 Then            If Buy01 = 0 Then                NextBuy01 = 0            ElseIf Buy02 = 0 Then                If Volume >= Buy01 Then                    NextBuy01 = 0                Else                    NextBuy01 = Buy01 - Volume                End If            ElseIf Buy03 = 0 Then                If Volume < Buy01 Then                    NextBuy01 = Buy01 - Volume                ElseIf Volume < Buy01 + Buy02 Then                    NextBuy01 = Buy01 + Buy02 - Volume                Else                    NextBuy01 = 0                End If            Else                If Volume < Buy01 Then                    NextBuy01 = Buy01 - Volume                ElseIf Volume < Buy01 + Buy02 Then                    NextBuy01 = Buy01 + Buy02 - Volume                ElseIf Volume < Buy01 + Buy02 + Buy03 Then                    NextBuy01 = Buy01 + Buy02 + Buy03 - Volume                Else                    NextBuy01 = 0                End If            End If    Else            If Buy01 = 0 Then                NextBuy01 = 0            ElseIf Buy02 = 0 Then                If Volume >= Buy01 Then                    NextBuy01 = 0                Else                    NextBuy01 = Buy01 - Volume                End If            ElseIf Buy03 = 0 Then                If Volume < Buy01 Then                    NextBuy01 = Buy01 - Volume                ElseIf Volume < Buy01 + Buy02 Then                    NextBuy01 = Buy01 + Buy02 - Volume                Else                    NextBuy01 = 0                End If            Else                If Volume < Buy01 Then                    NextBuy01 = Buy01 - Volume                ElseIf Volume < Buy01 + Buy02 Then                    NextBuy01 = Buy01 + Buy02 - Volume                ElseIf Volume < Buy01 + Buy02 + Buy03 Then                    NextBuy01 = Buy01 + Buy02 + Buy03 - Volume                Else                    NextBuy01 = 0                End If            End If        End IfEnd FunctionFunction NextSell01(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            If Sell01 <> 0 Then                NextSell01 = Sell01            ElseIf Sell02 <> 0 Then                If Volume < Sell11 Then                    NextSell01 = Sell01                Else                    NextSell01 = Sell02                End If            ElseIf Sell03 <> 0 Then                If Volume < Sell11 Then                    NextSell01 = Sell01                ElseIf Volume < Sell11 + Sell12 Then                    NextSell01 = Sell02                Else                    NextSell01 = Sell03                End If            Else                NextSell01 = 0            End If    ElseIf Operation = "Buy" And Price = 102 Then            If Volume < Sell01 + Sell11 Then                If Sell01 = 0 Then                    NextSell01 = 0                Else                    NextSell01 = Sell01 + Sell11 - Volume                End If            ElseIf Volume < Sell01 + Sell11 + Sell02 + Sell12 Then                If Sell02 = 0 Then                    NextSell01 = 0                Else                    NextSell01 = Sell01 + Sell11 + Sell02 + Sell12 - Volume                End If            ElseIf Volume < Sell01 + Sell02 + Sell03 + Sell11 + Sell12 + Sell13 Then                If Sell03 = 0 Then                    NextSell01 = 0                Else                    NextSell01 = Sell01 + Sell02 + Sell03 + Sell11 + Sell12 + Sell13 - Volume                End If            Else                NextSell01 = 0            End If    ElseIf Operation = "Sell" And Price = 101 Then            If Volume > Buy11 + Buy12 + Buy13 Then                NextSell01 = 0            Else                NextSell01 = Sell01            End If    Else            If Sell01 = 0 Then                If Volume > Buy01 + Buy02 + Buy03 Then                    NextSell01 = Volume - Buy01 - Buy02 - Buy03                Else                    NextSell01 = 0                End If            Else                NextSell01 = Sell01            End If    End IfEnd FunctionFunction NextSell02(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            If Sell01 <> 0 Then                NextSell02 = Sell02            Else                If Sell01 <> 0 Then                    NextSell02 = Sell02                ElseIf Sell02 <> 0 Then                    If Volume < Sell11 Then                        NextSell02 = Sell02                    Else                        NextSell02 = Sell03                    End If                Else                    NextSell02 = 0                End If            End If    ElseIf Operation = "Buy" And Price = 102 Then            If Volume < Sell01 + Sell11 Then                NextSell02 = Sell02            ElseIf Volume < Sell01 + Sell11 + Sell02 + Sell12 Then                NextSell02 = Sell03            Else                NextSell02 = 0            End If    ElseIf Operation = "Sell" And Price = 101 Then            If Sell11 = 0 Then                If Volume > Buy01 + Buy02 + Buy03 + Buy11 + Buy12 + Buy13 Then                    NextSell02 = Sell01                Else                    NextSell02 = Sell02                End If            Else                NextSell02 = Sell01            End If    Else            If Sell01 = 0 And Sell11 = 0 Then                NextSell02 = 0            ElseIf Sell02 = 0 And Sell12 = 0 Then                NextSell02 = Volume            Else                NextSell02 = Sell02            End If    End IfEnd FunctionFunction NextSell03(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            If Sell11 = 0 Then                NextSell03 = Sell03            Else                If Volume >= Sell11 Then                    NextSell03 = 0                Else                    NextSell03 = Sell03                End If            End If    ElseIf Operation = "Buy" And Price = 102 Then            If Volume < Sell01 + Sell11 Then                NextSell03 = Sell03            Else                NextSell03 = 0            End If    ElseIf Operation = "Sell" And Price = 101 Then            If Volume > Buy01 + Buy02 + Buy03 + Buy11 + Buy12 + Buy13 Then                NextSell03 = Sell02            Else                NextSell03 = Sell03            End If    Else            If Sell02 + Sell12 <> 0 Then                NextSell03 = Volume            Else                NextSell03 = 0            End If    End IfEnd FunctionFunction NextBuy13(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            If Buy12 <> 0 Or Buy02 <> 0 Then                NextBuy13 = Volume            Else                NextBuy13 = 0            End If    ElseIf Operation = "Buy" And Price = 102 Then            If Volume < Sell01 + Sell02 + Sell03 + Sell11 + Sell12 + Sell13 Then                NextBuy13 = Buy13            Else                NextBuy13 = Buy12            End If    ElseIf Operation = "Sell" And Price = 101 Then            If Volume < Buy01 + Buy11 Then                NextBuy13 = Buy13            Else                NextBuy13 = 0            End If    Else            If Buy01 = 0 Then                NextBuy13 = Buy13            Else                If Volume < Buy01 Then                    NextBuy13 = Buy13                Else                    NextBuy13 = 0                End If            End If    End IfEnd FunctionFunction NextBuy12(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            If Buy02 + Buy12 <> 0 Then                NextBuy12 = Buy12            ElseIf Buy01 + Buy11 <> 0 Then                NextBuy12 = Volume            Else                NextBuy12 = 0            End If    ElseIf Operation = "Buy" And Price = 102 Then            NextBuy12 = Buy11    ElseIf Operation = "Sell" And Price = 101 Then            If Volume < Buy01 + Buy11 Then                NextBuy12 = Buy12            ElseIf Volume < Buy01 + Buy11 + Buy02 + Buy12 Then                NextBuy12 = Buy13            Else                NextBuy12 = 0            End If    Else            If Buy01 = 0 Then                NextBuy12 = Buy12            ElseIf Buy02 = 0 Then                If Volume < Buy01 Then                    NextBuy12 = Buy12                Else                    NextBuy12 = Buy13                End If            ElseIf Buy03 = 0 Then                If Volume < Buy01 Then                    NextBuy12 = Buy12                ElseIf Volume < Buy01 + Buy02 Then                    NextBuy12 = Buy13                Else                    NextBuy12 = 0                End If            Else                If Volume < Buy01 Then                    NextBuy12 = Buy12                ElseIf Volume < Buy01 + Buy02 Then                    NextBuy12 = Buy13                Else                    NextBuy12 = 0                End If            End If    End IfEnd FunctionFunction NextBuy11(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            If Buy01 <> 0 Then                NextBuy11 = 0            ElseIf Sell01 + Sell11 = 0 And Buy01 + Buy11 <> 0 Then                NextBuy11 = Buy11            ElseIf Sell11 = 0 Then                NextBuy11 = Volume            Else                If Sell01 <> 0 Then                    NextBuy11 = Buy11                ElseIf Buy12 <> 0 Then                    NextBuy11 = Buy12                ElseIf Sell02 <> 0 Then                    If Volume < Sell11 Then                        NextBuy11 = 0                    Else                        NextBuy11 = Volume - Sell11                    End If                ElseIf Sell03 <> 0 Then                    If Volume < Sell11 + Sell12 Then                        NextBuy11 = 0                    Else                        NextBuy11 = Volume - Sell11 - Sell12                    End If                Else                    If Volume < Sell11 + Sell12 + Sell13 Then                        NextBuy11 = 0                    Else                        NextBuy11 = Volume - Sell11 - Sell12 - Sell13                    End If                End If            End If    ElseIf Operation = "Buy" And Price = 102 Then            NextBuy11 = 0    ElseIf Operation = "Sell" And Price = 101 Then            If Volume < Buy01 + Buy11 Then                If Buy11 = 0 Then                    NextBuy11 = 0                Else                    NextBuy11 = Buy11 - Volume                End If            ElseIf Volume < Buy01 + Buy11 + Buy02 + Buy12 Then                If Buy12 = 0 Then                    NextBuy11 = 0                Else                    NextBuy11 = Buy12 + Buy11 + Buy01 - Volume                End If            Else                If Buy13 = 0 Or Buy13 + Buy11 + Buy01 + Buy02 + Buy12 - Volume < 0 Then                    NextBuy11 = 0                Else                    NextBuy11 = Buy13 + Buy11 + Buy01 + Buy02 + Buy12 - Volume                End If            End If    Else            If Buy01 = 0 Then                NextBuy11 = Buy11            ElseIf Buy02 = 0 Then                If Volume < Buy01 Then                    NextBuy11 = 0                Else                    NextBuy11 = Buy12                End If            ElseIf Buy03 = 0 Then                If Volume < Buy01 Then                    NextBuy11 = 0                ElseIf Volume < Buy01 + Buy02 Then                    NextBuy11 = 0                Else                    NextBuy11 = Buy13                End If            Else                NextBuy11 = 0            End If    End IfEnd FunctionFunction NextSell11(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            If Sell01 <> 0 Then                NextSell11 = 0            ElseIf Sell11 = 0 Then                NextSell11 = 0            Else                If Volume < Sell11 Then                    NextSell11 = Sell11 - Volume                ElseIf Volume < Sell11 + Sell12 Then                    If Sell12 = 0 Then                        NextSell11 = 0                    Else                        NextSell11 = Sell11 + Sell12 - Volume                    End If                ElseIf Volume < Sell11 + Sell12 + Sell13 Then                    If Sell13 = 0 Then                        NextSell11 = 0                    Else                        NextSell11 = Sell11 + Sell12 + Sell13 - Volume                    End If                Else                    NextSell11 = 0                End If            End If    ElseIf Operation = "Buy" And Price = 102 Then            If Sell11 = 0 Then                NextSell11 = 0            ElseIf Sell12 = 0 Then                If Volume >= Sell11 Then                    NextSell11 = 0                Else                    NextSell11 = Sell11 - Volume                End If            ElseIf Sell13 = 0 Then                If Volume < Sell11 Then                    NextSell11 = Sell11 - Volume                ElseIf Volume < Sell11 + Sell12 Then                    NextSell11 = Sell11 + Sell12 - Volume                Else                    If Volume < Sell11 Then                        NextSell11 = Sell11 - Volume                    ElseIf Volume < Sell11 + Sell12 Then                        NextSell11 = Sell11 + Sell12 - Volume                    ElseIf Volume < Sell11 + Sell12 + Sell13 Then                        NextSell11 = Sell11 + Sell12 + Sell13 - Volume                    Else                        NextSell11 = 0                    End If                End If            Else                If Volume < Sell11 Then                    NextSell11 = Sell11 - Volume                Else                    NextSell11 = 0                End If            End If    ElseIf Operation = "Sell" And Price = 101 Then            If Sell11 <> 0 Then                NextSell11 = Sell11            Else                If Volume <= Buy01 + Buy11 + Buy02 + Buy12 + Buy03 + Buy13 Then                    NextSell11 = 0                Else                    NextSell11 = Volume - Buy01 - Buy11 - Buy02 - Buy12 - Buy03 - Buy13                End If            End If    Else            NextSell11 = Sell11    End IfEnd FunctionFunction NextSell12(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            If Sell01 <> 0 Then                NextSell12 = 0            Else                If Volume < Sell11 Then                    NextSell12 = Sell12                ElseIf Volume < Sell11 + Sell12 Then                    NextSell12 = Sell13                Else                    NextSell12 = 0                End If            End If    ElseIf Operation = "Buy" And Price = 102 Then            If Volume < Sell01 + Sell11 Then                NextSell12 = Sell12            ElseIf Volume < Sell01 + Sell11 + Sell02 + Sell12 Then                NextSell12 = Sell13            Else                NextSell12 = 0            End If    ElseIf Operation = "Sell" And Price = 101 Then            If Sell11 = 0 Then                NextSell12 = 0            ElseIf Sell12 <> 0 Then                NextSell12 = Sell12            Else                NextSell12 = Volume            End If    Else            NextSell12 = Sell12    End IfEnd FunctionFunction NextSell13(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Operation = "Buy" And Price = 101 Then            If Sell13 <> 0 And Volume >= Sell11 Then                NextSell13 = 0            Else                NextSell13 = Sell13            End If    ElseIf Operation = "Buy" And Price = 102 Then            If Volume >= Sell01 + Sell11 Then                NextSell13 = 0            Else                NextSell13 = Sell13            End If    ElseIf Operation = "Sell" And Price = 101 Then            If Sell12 <> 0 Then                NextSell13 = Volume            Else                NextSell13 = 0            End If    Else            NextSell13 = 0    End IfEnd FunctionFunction IsPossible(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13, Operation, Price, Volume)    If Buy02 + Buy12 <> 0 And Operation = "Buy" And Price = 101 Or Sell03 <> 0 And Operation = "Sell" And Price = 102 Then        IsPossible = False    Else        IsPossible = TrueEnd FunctionFunction Symb(x)    If x = 0 Then        Symb = "0"    ElseIf x = 1 Then        Symb = "1"    Else        Symb = "M"End FunctionFunction GetHyperState(Buy03, Buy02, Buy01, Sell01, Sell02, Sell03, Buy13, Buy12, Buy11, Sell11, Sell12, Sell13)    GetHyperState = Symb(Buy03) & Symb(Buy02) & Symb(Buy01) & Symb(Sell01) & Symb(Sell02) & Symb(Sell03) & "-" & Symb(Buy13) & Symb(Buy12) & Symb(Buy11) & Symb(Sell11) & Symb(Sell12) & Symb(Sell13)End FunctionFunction GetInfo()    GetInfo = Array(12, 3, Array("Buy", "Sell"), Array(101, 102), Array(1, 2, 3, 4, 5, 6, 7, 8, 9))End FunctionFunction GetStartPosition()    GetStartPosition = Array(0,0,0,0,0,0,0,0,0,0,0,0)End FunctionFunction StopCondition(a,b,c,d,e,f,g,h,i,j,k,l)    StopCondition = FalseEnd Function